<html>
    <head>
        <title>Test Extractor</title>
        <script src="../lib/umd/index.min.js"></script>
        <script type="text/javascript">
            let input, file, fr;

            function loadImage() {
                input = document.getElementById("file");
                file = input.files[0];
                fr = new FileReader();
                fr.onload = displayImage;
                fr.readAsDataURL(file);
            }

            function displayImage() {
                const img = document.getElementById("img");
                img.onload = runExtractor;
                img.src = fr.result;
            }

            function runExtractor() {
                const canvas = document.getElementById("canvas");
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0);
                const imgData = ctx.getImageData(0, 0, img.width, img.height);

                const binarizer = new iching.AdaptiveBinarizer();
                const matrix = binarizer.binarize(imgData.data, imgData.width, imgData.height);
                const myData = new iching.ImageData(matrix);
                const ctxImageData = new ImageData(myData.data, myData.width, myData.height);
                ctx.putImageData(ctxImageData, 0, 0);

                const extractor = new iching.Extractor();
                console.log(extractor.extract(matrix)["data"]);
            }
        </script>
    </head>
    <body>
        <form action="#" onsubmit="return false;">
            <input type="file" id="file"/>
            <input type="button" id="btnLoad" value="Load" onclick="loadImage()"/>
        </form>
        <img id="img">
        <canvas id="canvas"></canvas>
    </body>
</html>
